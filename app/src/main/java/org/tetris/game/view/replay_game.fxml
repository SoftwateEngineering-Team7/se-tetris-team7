<?xml version="1.0" encoding="UTF-8"?>

<?import javafx.geometry.Insets?>
<?import javafx.scene.control.Button?>
<?import javafx.scene.control.Label?>
<?import javafx.scene.effect.DropShadow?>
<?import javafx.scene.layout.BorderPane?>
<?import javafx.scene.layout.HBox?>
<?import javafx.scene.layout.Pane?>
<?import javafx.scene.layout.StackPane?>
<?import javafx.scene.layout.VBox?>
<?import javafx.scene.paint.Color?>
<?import javafx.scene.text.Font?>

<StackPane xmlns="http://javafx.com/javafx"
           xmlns:fx="http://javafx.com/fxml"
           prefWidth="1000" prefHeight="600">

    <BorderPane fx:id="root"
                prefWidth="1000" prefHeight="600"
                style="-fx-background-color: #1a1a2e;">

        <!-- ============== 상단: Replay 정보 ============== -->
        <top>
            <HBox alignment="CENTER" spacing="40"
                  style="-fx-background-color: #16213e; -fx-padding: 10;">
                <children>
                    <Label text="REPLAY MODE" textFill="#FFA500">
                        <font>
                            <Font name="Arial Black" size="24.0" />
                        </font>
                        <effect>
                            <DropShadow height="10.0" radius="4.5" width="10.0">
                                <color>
                                    <Color opacity="0.5" />
                                </color>
                            </DropShadow>
                        </effect>
                    </Label>
                </children>
            </HBox>
        </top>

        <!-- ============== 중앙: 두 개의 게임 보드 ============== -->
        <center>
            <HBox alignment="CENTER" spacing="60">
                <children>
                    <!-- 상대방 보드 (왼쪽) -->
                    <VBox alignment="CENTER" spacing="20">
                        <children>
                            <Pane fx:id="gameBoard2"
                                  prefWidth="300" prefHeight="600">
                                <style>-fx-background-color: black; -fx-border-color: #333; -fx-border-width: 2;</style>
                            </Pane>
                        </children>
                    </VBox>

                    <!-- 본인 보드 (오른쪽) -->
                    <VBox alignment="CENTER" spacing="20">
                        <children>
                            <Pane fx:id="gameBoard1"
                                  prefWidth="300" prefHeight="600">
                                <style>-fx-background-color: black; -fx-border-color: #333; -fx-border-width: 2;</style>
                            </Pane>
                        </children>
                    </VBox>
                </children>
            </HBox>
        </center>

        <!-- ============== 왼쪽: 상대방 (Player 2) 정보 ============== -->
        <left>
            <VBox alignment="TOP_CENTER" spacing="15"
                  prefWidth="200"
                  style="-fx-background-color: #16213e;">
                <children>
                    <Label text="PLAYER 2" textFill="white">
                        <font>
                            <Font name="Arial Black" size="20.0" />
                        </font>
                    </Label>

                    <!-- NEXT -->
                    <VBox alignment="CENTER" spacing="5">
                        <children>
                            <Label text="NEXT" textFill="#e94560">
                                <font>
                                    <Font name="Arial Black" size="16.0" />
                                </font>
                            </Label>
                            <Pane fx:id="nextBlockPane2"
                                  prefWidth="150" prefHeight="100"
                                  style="-fx-background-color: #0f3460; -fx-border-color: #533483; -fx-border-width: 2;">
                            </Pane>
                        </children>
                    </VBox>

                    <!-- ATTACK -->
                    <VBox alignment="CENTER" spacing="5">
                        <children>
                            <Label text="ATTACK" textFill="#e94560">
                                <font>
                                    <Font name="Arial Black" size="16.0" />
                                </font>
                            </Label>
                            <Pane fx:id="attackPreviewPane2"
                                  prefWidth="180" prefHeight="180"
                                  minWidth="180" maxWidth="180"
                                  minHeight="180" maxHeight="180"
                                  style="-fx-background-color: #000000; -fx-border-color: #e94560; -fx-border-width: 1;">
                            </Pane>
                        </children>
                    </VBox>

                    <!-- SCORE -->
                    <VBox alignment="CENTER" spacing="2">
                        <children>
                            <Label text="SCORE" textFill="#e94560">
                                <font>
                                    <Font name="Arial Black" size="14.0" />
                                </font>
                            </Label>
                            <Label fx:id="scoreLabel2" text="0" textFill="white">
                                <font>
                                    <Font name="Consolas Bold" size="20.0" />
                                </font>
                            </Label>
                        </children>
                    </VBox>
                    
                </children>
                <BorderPane.margin>
                    <Insets top="20.0" left="20.0" bottom="20.0" right="10.0" />
                </BorderPane.margin>
            </VBox>
        </left>

        <!-- ============== 오른쪽: 본인 (Player 1) 정보 ============== -->
        <right>
            <VBox alignment="TOP_CENTER" spacing="10"
                  prefWidth="200"
                  style="-fx-background-color: #16213e;">
                <children>
                    <Label text="PLAYER 1" textFill="white">
                        <font>
                            <Font name="Arial Black" size="20.0" />
                        </font>
                    </Label>

                    <!-- NEXT -->
                    <VBox alignment="CENTER" spacing="5">
                        <children>
                            <Label text="NEXT" textFill="#e94560">
                                <font>
                                    <Font name="Arial Black" size="16.0" />
                                </font>
                            </Label>
                            <Pane fx:id="nextBlockPane1"
                                  prefWidth="150" prefHeight="100"
                                  style="-fx-background-color: #0f3460; -fx-border-color: #533483; -fx-border-width: 2;">
                            </Pane>
                        </children>
                    </VBox>

                    <!-- ATTACK -->
                    <VBox alignment="CENTER" spacing="5">
                        <children>
                            <Label text="ATTACK" textFill="#e94560">
                                <font>
                                    <Font name="Arial Black" size="16.0" />
                                </font>
                            </Label>
                            <Pane fx:id="attackPreviewPane1"
                                  prefWidth="180" prefHeight="180"
                                  minWidth="180" maxWidth="180"
                                  minHeight="180" maxHeight="180"
                                  style="-fx-background-color: #000000; -fx-border-color: #e94560; -fx-border-width: 1;">
                            </Pane>
                        </children>
                    </VBox>

                    <!-- SCORE -->
                    <VBox alignment="CENTER" spacing="2">
                        <children>
                            <Label text="SCORE" textFill="#e94560">
                                <font>
                                    <Font name="Arial Black" size="14.0" />
                                </font>
                            </Label>
                            <Label fx:id="scoreLabel1" text="0" textFill="white">
                                <font>
                                    <Font name="Consolas Bold" size="20.0" />
                                </font>
                            </Label>
                        </children>
                    </VBox>
                </children>
                <BorderPane.margin>
                    <Insets top="20.0" right="20.0" bottom="20.0" left="10.0" />
                </BorderPane.margin>
            </VBox>
        </right>

        <!-- ============== 하단: Replay 컨트롤 ============== -->
        <bottom>
            <HBox fx:id="replayControlOverlay" alignment="CENTER" spacing="20"
                  style="-fx-background-color: rgba(0, 0, 0, 0.8); -fx-padding: 15;">
                <children>
                    <Label text="SPEED:" textFill="white">
                        <font>
                            <Font name="Arial Bold" size="14.0" />
                        </font>
                    </Label>
                    <Button fx:id="speedDownButton" text="&lt;&lt;" 
                            style="-fx-background-color: #533483; -fx-text-fill: white; -fx-font-weight: bold;"/>
                    <Label fx:id="replaySpeedLabel" text="1.0x" textFill="#e94560" minWidth="50" alignment="CENTER">
                        <font>
                            <Font name="Consolas Bold" size="18.0" />
                        </font>
                    </Label>
                    <Button fx:id="speedUpButton" text="&gt;&gt;" 
                            style="-fx-background-color: #533483; -fx-text-fill: white; -fx-font-weight: bold;"/>
                    
                    <Pane HBox.hgrow="ALWAYS" /> <!-- Spacer -->
                    
                    <Button fx:id="exitReplayButton" text="EXIT REPLAY" 
                            style="-fx-background-color: #e94560; -fx-text-fill: white; -fx-font-weight: bold; -fx-padding: 5 15 5 15;"/>
                </children>
            </HBox>
        </bottom>

    </BorderPane>

    <!-- ============== 게임 오버 오버레이 (결과 표시용) ============== -->
    <HBox fx:id="gameOverOverlay" alignment="CENTER"
          visible="false" managed="false"
          prefWidth="1000" prefHeight="600"
          style="-fx-background-color: rgba(0, 0, 0, 0.8);">
        <children>
            <VBox alignment="CENTER" spacing="15">
                <children>
                    <Label fx:id="winnerLabel" text="REPLAY FINISHED" textFill="white">
                        <font>
                            <Font name="Arial Bold" size="24.0" />
                        </font>
                    </Label>
                    <Button fx:id="restartButton" text="REPLAY AGAIN"
                            prefWidth="150" prefHeight="40"
                            style="-fx-background-color: #FFA500; -fx-text-fill: white; -fx-background-radius: 5;">
                        <font>
                            <Font name="Arial Bold" size="16.0" />
                        </font>
                    </Button>
                    <Button fx:id="menuButton" text="MENU"
                            prefWidth="150" prefHeight="40"
                            style="-fx-background-color: #533483; -fx-text-fill: white; -fx-background-radius: 5;">
                        <font>
                            <Font name="Arial Bold" size="16.0" />
                        </font>
                    </Button>
                </children>
            </VBox>
        </children>
    </HBox>

    <!-- ============== 일시정지 오버레이 ============== -->
    <HBox fx:id="pauseOverlay" alignment="CENTER"
          visible="false" managed="false"
          prefWidth="1000" prefHeight="600"
          style="-fx-background-color: rgba(0, 0, 0, 0.7);">
        <children>
            <VBox alignment="CENTER" spacing="20">
                <children>
                    <Label text="PAUSED" textFill="#533483">
                        <font>
                            <Font name="Arial Black" size="48.0" />
                        </font>
                    </Label>
                </children>
            </VBox>
        </children>
    </HBox>

    <!-- ============== Hidden Fields for DualGameController Inheritance ============== -->
    <VBox visible="false" managed="false">
        <children>
        <!-- Pause 버튼 -->
                    <Button fx:id="pauseButton" text="PAUSE"
                            prefWidth="150" prefHeight="30"
                            style="-fx-background-color: #533483; -fx-text-fill: white; -fx-background-radius: 5;">
                        <font>
                            <Font name="Arial Bold" size="12.0" />
                        </font>
                        <effect>
                            <DropShadow height="8.0" radius="3.5" width="8.0">
                                <color>
                                    <Color opacity="0.5" />
                                </color>
                            </DropShadow>
                        </effect>
                        <VBox.margin>
                            <Insets top="10.0" />
                        </VBox.margin>
                    </Button>
            <!-- Level & Lines Labels -->
            <Label fx:id="levelLabel1" />
            <Label fx:id="linesLabel1" />
            <Label fx:id="levelLabel2" />
            <Label fx:id="linesLabel2" />

            <!-- Time Attack UI -->
            <VBox fx:id="timeAttackBox1">
                <Label fx:id="timerLabel1" />
            </VBox>
            <VBox fx:id="timeAttackBox2">
                <Label fx:id="timerLabel2" />
            </VBox>

            <!-- Control Labels -->
            <Label fx:id="moveControlLabel1" />
            <Label fx:id="rotateControlLabel1" />
            <Label fx:id="softDropControlLabel1" />
            <Label fx:id="hardDropControlLabel1" />
            <Label fx:id="moveControlLabel2" />
            <Label fx:id="rotateControlLabel2" />
            <Label fx:id="softDropControlLabel2" />
            <Label fx:id="hardDropControlLabel2" />

            <!-- Missing Buttons -->
            <Button fx:id="resumeButton" />
            <Button fx:id="pauseMenuButton" />
        </children>
    </VBox>

</StackPane>
